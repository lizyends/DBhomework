#### 第一题

##### 1. 

$\pi_{O.ordno,C.city,A.city}(\sigma_{O.cid=C.cid\and O.aid=A.aid \and C.city!=A.city}(C\times A\times O))$

##### 2.

$\pi_{C.cname}(C)-\pi_{C.cname}(\sigma_{O.ordyear>2022\and O.cid=C.cid}(C\times O))$

##### 3. 

$\pi_{O.aid,C.city}(\pi_{cid,O.aid,O.ordno}(O)\bowtie \pi_{cid,C.city}(C))\div \pi_{C.city}(C)$

不用除法的表示为：

令$T:=\pi_{cid,O.aid,O.ordno}(O)\bowtie \pi_{cid,C.city}(C)$

$\pi_{O.aid}(T)-\pi_{O.aid}(\pi_{cid,O.aid}(T)\times\pi_{city}(C)-\pi_{cid,O.aid,C.city}(T))$

##### 4.

$\pi_{A.aid,C.city,C.cname}((C\bowtie \pi_{O.aid,O.cid,O.ordno}(O)\bowtie A))\div \pi_{C.cname}(\sigma_{city=r\_city}(C))$

##### 5.

不用除法：

$D:=\pi_{cid,dis}(C)$

$\pi_{C.cid}(C)-\pi_{C.cid}(\sigma_{C.dis>D.dis}(\pi_{C.dis,C.cid}(C)\times D))$

用除法

$D\div (\pi_{C.dis}(C)-\pi_{C.dis}(\pi_{C.cid,C.dis}(C)\bowtie_{C.dis>D.dis} D))$  (被除数是在找最低的dis)



#### 第二题

##### 1.

$\pi_{sno,sname}((\sigma_{dept='计算机系'}(C)\bowtie L)\bowtie \pi_{sno,sname}(S))$

##### 2.

$\pi_{sno,sname}((L\bowtie C-L\bowtie (\sigma_{cname='数据库'}(C)))\bowtie \pi_{sno,sname}(S))$

##### 3.

$\pi_{sno,sname}(\sigma_{score>=60}(  (\pi_{sno,cno}(L)\div \pi_{cno}(\sigma_{dept='计算机系'\and opt='必修'}(C)))\bowtie L  )\bowtie S)$

##### 4.

$(\pi_{sno,sname}(S)-\pi_{sno,sname}(\sigma_{opt='必修'}(L\bowtie (\sigma_{grade=2019}(S)\bowtie C))))\cup(\sigma_{opt='必修'\and score<60}(L\bowtie (\sigma_{grade=2019}(S)\bowtie C)))$

##### 5.

$T:=\pi_{L.sno,L.cno,L.score}(S\bowtie L)$

$\pi_{sno,sname}(S)\bowtie(\pi_{sno}(L)-\pi_{sno}(\sigma_{L.cno=T.cno\and L.score<T.score}(\pi_{L.sno,L.cno,L.score}(S\bowtie L)\times T)))$